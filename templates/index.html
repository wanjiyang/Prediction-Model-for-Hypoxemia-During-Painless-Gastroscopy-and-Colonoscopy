<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hypoxemia Risk Prediction During Painless Gastroscopy</title>
    <link rel="stylesheet" href="styles.css"> <!-- Assuming styles are in a separate CSS file -->
</head>
<body>
<div class="container">
    <h2>Hypoxemia Risk Prediction During Painless Gastroscopy</h2>
    <p class="info">Please fill in the following information to predict the likelihood of hypoxemia occurring during the procedure.</p>
    <form id="predictionForm">
        <div class="form-section">
            <!-- Basic Patient Information -->
            <div class="form-group">
                <h3>Basic Patient Information</h3>
                <label for="Gender">Gender*</label>
                <select id="Gender" name="Gender" required>
                    <option value="">Please select</option>
                    <option value="0">Male</option>
                    <option value="1">Female</option>
                </select>

                <label for="Age">Age*</label>
                <input type="number" id="Age" name="Age" required>

                <label for="Height">Height (cm)*</label>
                <input type="number" id="Height" name="Height" required>

                <label for="Weight">Weight (kg)*</label>
                <input type="number" id="Weight" name="Weight" required>

                <label for="BMI">BMI*</label>
                <select id="BMI" name="BMI" required>
                    <option value="">Please select</option>
                    <option value="0">≤ 15.4</option>
                    <option value="1">15.4 - 21.6</option>
                    <option value="2">21.6 - 24.0</option>
                    <option value="3">24.0 - 26.4</option>
                    <option value="4">26.4 - 40.2</option>
                    <option value="5">> 40.2</option>
                </select>

                <label for="NC">Neck Circumference (cm)*</label>
                <select id="NC" name="NC" required>
                    <option value="">Please select</option>
                    <option value="0">≤ 34</option>
                    <option value="1">34 - 37</option>
                    <option value="2">37 - 41</option>
                    <option value="3">> 41</option>
                </select>

                <label for="Years_of_Surgical_Experience">Years of Surgical Experience*</label>
                <input type="number" id="Years_of_Surgical_Experience" name="Years of Surgical Experience" required>
            </div>

            <!-- Medical Evaluation -->
            <div class="form-group">
                <h3>Medical Evaluation</h3>
                <label for="Cardiovascular_Disease">Cardiovascular Disease*</label>
                <select id="Cardiovascular_Disease" name="Cardiovascular Disease" required>
                    <option value="">Please select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>

                <label for="Other_Diseases">Other Diseases*</label>
                <select id="Other_Diseases" name="Other Diseases" required>
                    <option value="">Please select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>

                <label for="ASA">ASA Physical Status Classification*</label>
                <select id="ASA" name="ASA" required>
                    <option value="">Please select</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                </select>

                <label for="STOP_BANG">STOP-BANG Score (0-8)*</label>
                <select id="STOP_BANG" name="STOP-BANG" required>
                    <option value="">Please select</option>
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                </select>
            </div>

            <!-- Surgery Details -->
            <div class="form-group">
                <h3>Surgery Details</h3>
                <label for="Propofol_Dosage">Propofol Dosage (mg)*</label>
                <input type="number" id="Propofol_Dosage" name="Propofol Dosage" required>

                <label for="Oxygen_Flow_Rate">Oxygen Flow Rate (L/min)*</label>
                <input type="number" id="Oxygen_Flow_Rate" name="Oxygen Flow Rate" required>

                <label for="Surgery_Type_2">Underwent Colonoscopy*</label>
                <select id="Surgery_Type_2" name="Surgery Type-2" required>
                    <option value="">Please select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>

                <label for="Surgery_Type_3">Underwent Gastrointestinal Endoscopy*</label>
                <select id="Surgery_Type_3" name="Surgery Type-3" required>
                    <option value="">Please select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>

                <label for="Surgery_Type_4">Underwent Endoscopic Mucosal Resection (EMR)*</label>
                <select id="Surgery_Type_4" name="Surgery Type-4" required>
                    <option value="">Please select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>

            <!-- Risk Factors -->
            <div class="form-group">
                <h3>Risk Factors</h3>
                <label for="Smoking">Smoking History*</label>
                <select id="Smoking" name="Smoking" required>
                    <option value="">Please select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>

                <label for="Drinking">Alcohol Consumption History*</label>
                <select id="Drinking" name="Drinking" required>
                    <option value="">Please select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>

                <label for="Snoring">Snoring*</label>
                <select id="Snoring" name="Snoring" required>
                    <option value="">Please select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>

                <label for="Tired">Often Feel Tired*</label>
                <select id="Tired" name="Tired" required>
                    <option value="">Please select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>

                <label for="Observed_Apnea">Observed Apnea During Sleep*</label>
                <select id="Observed_Apnea" name="Observed Apnea" required>
                    <option value="">Please select</option>
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>

                <label for="Inpatient_Status">Patient Status*</label>
                <select id="Inpatient_Status" name="Inpatient Status" required>
                    <option value="">Please select</option>
                    <option value="0">Outpatient</option>
                    <option value="1">Inpatient</option>
                </select>
            </div>

            <button type="submit">Predict Risk</button>
        </div>
    </form>

    <div class="result-section" id="resultSection"></div>
    <div class="suggestions-section" id="suggestionsSection"></div>
</div>

<script>
    // Event listener for the form submission
    document.getElementById('predictionForm').addEventListener('submit', function(event) {
        event.preventDefault();
        const formData = new FormData(this);
        const jsonData = {};
        formData.forEach((value, key) => { jsonData[key] = value; });

        fetch('/predict', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(jsonData)
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById('resultSection').textContent = data.prediction || 'Error: ' + data.error;
            document.getElementById('suggestionsSection').textContent = data.suggestions || '';
        })
        .catch(error => {
            document.getElementById('resultSection').textContent = 'Network or server error';
            document.getElementById('suggestionsSection').textContent = '';
        });
    });
</script>
</body>
</html>
